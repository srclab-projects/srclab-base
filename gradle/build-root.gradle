description = "Build for projects"

// Gradle files to be applied:
ext["gradles"] = [
    utils         : "${rootProject.rootDir}/buildSrc/utils.gradle",
    repositories  : "${rootProject.rootDir}/buildSrc/repositories.gradle",
    deployJar     : "${rootProject.rootDir}/buildSrc/deploy-jar.gradle",
    deployPlatform: "${rootProject.rootDir}/buildSrc/deploy-platform.gradle",
    compile       : "${rootProject.rootDir}/buildSrc/compile.gradle",
    passwords     : "${rootProject.rootDir}/buildSrc/passwords.gradle",
    infos         : "${rootProject.rootDir}/buildSrc/infos.gradle",
]

apply from: gradles.utils
apply from: gradles.infos

if (utils.needLoginSigning) {
  apply from: gradles.passwords
}

allprojects { p ->
  //Do for each project
  processProject(p)
}

subprojects { p ->
  //Do for each project
}

tasks.withType(JavaCompile) {
  options.encoding = "UTF-8"
}

def processProject(anyProject) {
  anyProject.group = infos.group
  anyProject.version = infos.version
  if (anyProject == rootProject) {
    println("Configure root ${anyProject.group}:${anyProject.name}:${anyProject.version}")
  } else {
    println("Configure sub  ${anyProject.group}:${anyProject.name}:${anyProject.version}")
  }
}